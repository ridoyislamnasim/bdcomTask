<%- include(`../commonPartial/header.ejs`); %>
<%- include(`../commonPartial/menu.ejs`); %>

<section class="home-section">
  <div class="home-content">
    <div class="manageAddRoom-container">
      <div id="title">
        <h2>Manage Room</h2>
      </div>

      <!-- <div class="new-room-container new-room">
        <button class="newadd" onclick="openAddRoomsModal()"> Add New Room </button>
      </div> -->
      <div class="table_top">
        <div class="left">
            <button class="newadd" onclick="openAddRoomsModal()">Add New Room</button>
        </div>
        <div class="right">
            <div class="sub-right">
              <div class="right-sub-item">
                <span>Total rooms : </span><span><%= room_top_info.totalRooms  %></span>
              </div>
              <div class="right-sub-item">
                <span>Total number of seats : </span><span><%=  room_top_info.totalSeats   %></span>
              </div>
            </div>
            <div class="sub-right" >
              <div class="right-sub-item">
                <span>Total theory rooms seats : </span><span><%=  room_top_info.totaTheorySeats   %></span>
              </div>
              <div class="right-sub-item">
                <span>Total lab rooms seats : </span><span><%=  room_top_info.totaLabSeats   %></span>
              </div>
            </div>

        </div>
    </div>

      <div id="rooms-table">
        <!-- <div id="tableContainer"> -->
        <table id="roomTable">
          <thead>
            <tr id="tableHeader">
              <th>Room Number</th>
              <th>Department</th>
              <th>Total</th>
              <th>Even total</th>
              <th>Odd totall</th>
              <th>Room sataus</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="roomsTable">
            <p id="coloumsmax" style="display: none;">
              <%= coloumsmax %>
            </p>
            <% for(let room of rooms){%>
            <tr id="">
              <td class="roomNumber">
                <span><%= room.roomnumber %></span>
              </td>
              <td class="Faculty_Roomname">
                <span><%= room.departmentname %></span>
              </td>

              <% for (var i=0; i < room.rowsNumber.length ; i++) { %>
              <td class="cloumn_row"> 
                <span><%= room.cloumn[i] %></span> /<span> <%= room.rowsNumber[i] %></span>
               </td>
              <% } %>

              <% for (var i=room.rowsNumber.length; i < coloumsmax ; i++) { %>
              <td><span>-</span></td>
              <% } %>

              <td class="totalcapasity">
                <span><%= room.totalcapasity %></span>
              </td>
              <td class="evencapasity">
                <span><%= room.evencapasity %></span>
              </td>
              <td class="oddcapasity">
                <span><%= room.oddcapasity %></span>
              </td>
              <td class="roomstatus">
                <span><%= room.roomstatus %></span>
              </td>
              <td class="manage"> 
                <a method="delete" href="#" onclick="roomEditHandel(this,'<%= room._id  %>')">
                  <i class="fa-solid fa-pen-to-square"></i>

                </a>
                <!-- onclick="deleteUser" -->
                <a method="delete" href="#" onclick="openDeleteModal('<%= room._id %>')">
                  <i class="fa-solid fa-trash"></i>
                </a>
              </td>

              <!--  -->
              <p id="roomid" style="display: none;">
                <%= room._id %>
              </p>
            </tr>
            <%} %>


          </tbody>
        </table>
        <!-- </div> -->
      </div>
    </div>
  </div>
</section>




<!-- manu open close -->
<%- include(`../commonPartial/manuOpenCloseScript.ejs`); %>

<script>
  let table = document.getElementById("roomTable");
  let coloumsmax = document.getElementById("coloumsmax");
  console.log("table", table)
  console.log("tablcoloumsmaxe,", typeof(coloumsmax.innerHTML))
  let maxnumberOfColumns = Number(coloumsmax.innerHTML);
  for (let i = 0; i < maxnumberOfColumns; i++) {
    console.log(i);
    let headerRow = table.rows[0];
    console.log("headerRow", headerRow)
    let newHeaderCell = headerRow.insertCell(i + 2);
    newHeaderCell.innerHTML = `Column ${i + 1}`;
  }
</script>

<script>
  $(document).ready(function() {
    $('#roomTable').DataTable({
      "pagingType": "full_numbers",
    "oLanguage": {
      "oPaginate": {
        "sFirst": "First",
        "sPrevious": "Previous",
        "sNext": "Next",
        "sLast": "Last"
      }
    }
    });
  });
</script>




<!-- add Rooms -->
<%- include(`./delete.ejs`); %>
<%- include(`./add.ejs`); %>
<%- include(`./edit.ejs`); %>
</body>
</html>